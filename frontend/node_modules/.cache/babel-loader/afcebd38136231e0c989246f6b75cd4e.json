{"ast":null,"code":"import _regeneratorRuntime from\"/home/kjchan/step-react-ads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/kjchan/step-react-ads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/home/kjchan/step-react-ads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/kjchan/step-react-ads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/kjchan/step-react-ads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/kjchan/step-react-ads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/kjchan/step-react-ads/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */import React from'react';import axios from'axios';import*as HttpStatus from'http-status-codes';import{makeStyles}from'@material-ui/core/styles';import QueryResults from'./QueryResults';import TextField from'@material-ui/core/TextField';import Button from'@material-ui/core/Button';import Title from'../../Utilities/Title';var useStyles=makeStyles(function(theme){return{root:{margin:theme.spacing(1)}};});//JSON data parsing here\nfunction addKey(index,responseObj){responseObj.id=index;return responseObj;}function parseRows(response){var responseRows=[];var i;for(i=0;i<response.length;i++){responseRows.push(addKey(i,response[i]));}return responseRows;}var Query=/*#__PURE__*/function(_React$Component){_inherits(Query,_React$Component);var _super=_createSuper(Query);function Query(props){var _this;_classCallCheck(this,Query);_this=_super.call(this,props);_this.handleChange=_this.handleChange.bind(_assertThisInitialized(_this));_this.handleQuery=_this.handleQuery.bind(_assertThisInitialized(_this));_this.state={value:'',rows:[],fields:[],rowsPerPage:5,status:'inputRequired',errorMessage:''};return _this;}_createClass(Query,[{key:\"handleQuery\",value:function(){var _handleQuery=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var query,_yield$axios$post,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:query=this.state.value;this.setState({status:'loading'});_context.prev=2;_context.next=5;return axios.post('/campaign',new URLSearchParams({query:query}));case 5:_yield$axios$post=_context.sent;data=_yield$axios$post.data;console.log(data);if(!(data.meta.status!==HttpStatus.OK.toString())){_context.next=12;break;}throw new Error(data.meta.message);case 12:this.setState({rows:parseRows(data.response),fields:data.fieldmask,status:'loaded'});case 13:_context.next=19;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](2);console.log(_context.t0.message);this.setState({status:'error',errorMessage:_context.t0.message});case 19:case\"end\":return _context.stop();}}},_callee,this,[[2,15]]);}));function handleQuery(){return _handleQuery.apply(this,arguments);}return handleQuery;}()},{key:\"pickContentToDisplay\",value:function pickContentToDisplay(){switch(this.state.status){case'inputRequired':return/*#__PURE__*/React.createElement(Title,null,\" Enter a query to see the results \");case'loading':return/*#__PURE__*/React.createElement(Title,null,\" Loading ... \");case'loaded':return/*#__PURE__*/React.createElement(QueryResults,{rows:this.state.rows,fields:this.state.fields,rowsPerPage:this.state.rowsPerPage});case'error':return/*#__PURE__*/React.createElement(Title,null,\"Something Went Wrong. Here's the Error Message: \"+this.state.errorMessage);default:return/*#__PURE__*/React.createElement(Title,null,\" Something Went Wrong\");}}},{key:\"handleChange\",value:function handleChange(event){this.setState({value:event.target.value});}},{key:\"render\",value:function render(){// const rows = this.state.rows;\n// const fields = this.state.fields;\nreturn/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Title,null,\"Query Here\"),/*#__PURE__*/React.createElement(TextField,{value:this.state.value,onChange:this.handleChange,id:\"standard-full-width\",label:\"Enter Query\",style:{margin:8},placeholder:\"SELECT campaign.id, campaign.name FROM campaign\",helperText:\"make sure to select an account!\",fullWidth:true,margin:\"normal\",InputLabelProps:{shrink:true}}),/*#__PURE__*/React.createElement(SubmitButton,{onClick:this.handleQuery}),this.pickContentToDisplay());}}]);return Query;}(React.Component);function SubmitButton(props){var classes=useStyles();return/*#__PURE__*/React.createElement(\"div\",{className:classes.root},/*#__PURE__*/React.createElement(Button,{variant:\"outlined\",onClick:props.onClick},\"Submit\"));}export default Query;","map":{"version":3,"sources":["/home/kjchan/step-react-ads/client/src/Dashboard/PageComponents/QueryDashboard/Queries.js"],"names":["React","axios","HttpStatus","makeStyles","QueryResults","TextField","Button","Title","useStyles","theme","root","margin","spacing","addKey","index","responseObj","id","parseRows","response","responseRows","i","length","push","Query","props","handleChange","bind","handleQuery","state","value","rows","fields","rowsPerPage","status","errorMessage","query","setState","post","URLSearchParams","data","console","log","meta","OK","toString","Error","message","fieldmask","event","target","shrink","pickContentToDisplay","Component","SubmitButton","classes","onClick"],"mappings":"4iCAAA;;;;;;;;;;;;;;GAeA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,MAAO,GAAKC,CAAAA,UAAZ,KAA4B,mBAA5B,CACA,OAASC,UAAT,KAA2B,0BAA3B,CACA,MAAOC,CAAAA,YAAP,KAAyB,gBAAzB,CACA,MAAOC,CAAAA,SAAP,KAAsB,6BAAtB,CACA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,KAAP,KAAkB,uBAAlB,CAEA,GAAMC,CAAAA,SAAS,CAAGL,UAAU,CAAC,SAACM,KAAD,QAAY,CACvCC,IAAI,CAAE,CACJC,MAAM,CAAEF,KAAK,CAACG,OAAN,CAAc,CAAd,CADJ,CADiC,CAAZ,EAAD,CAA5B,CAMA;AACA,QAASC,CAAAA,MAAT,CAAgBC,KAAhB,CAAuBC,WAAvB,CAAoC,CAClCA,WAAW,CAACC,EAAZ,CAAiBF,KAAjB,CACA,MAAOC,CAAAA,WAAP,CACD,CAED,QAASE,CAAAA,SAAT,CAAmBC,QAAnB,CAA6B,CAC3B,GAAMC,CAAAA,YAAY,CAAG,EAArB,CACA,GAAIC,CAAAA,CAAJ,CACA,IAAKA,CAAC,CAAG,CAAT,CAAYA,CAAC,CAAGF,QAAQ,CAACG,MAAzB,CAAiCD,CAAC,EAAlC,CAAsC,CACpCD,YAAY,CAACG,IAAb,CAAkBT,MAAM,CAACO,CAAD,CAAIF,QAAQ,CAACE,CAAD,CAAZ,CAAxB,EACD,CACD,MAAOD,CAAAA,YAAP,CACD,C,GAEKI,CAAAA,K,0GACJ,eAAYC,KAAZ,CAAmB,uCACjB,uBAAMA,KAAN,EACA,MAAKC,YAAL,CAAoB,MAAKA,YAAL,CAAkBC,IAAlB,+BAApB,CACA,MAAKC,WAAL,CAAmB,MAAKA,WAAL,CAAiBD,IAAjB,+BAAnB,CACA,MAAKE,KAAL,CAAa,CACXC,KAAK,CAAE,EADI,CAEXC,IAAI,CAAE,EAFK,CAGXC,MAAM,CAAE,EAHG,CAIXC,WAAW,CAAE,CAJF,CAKXC,MAAM,CAAE,eALG,CAMXC,YAAY,CAAE,EANH,CAAb,CAJiB,aAYlB,C,qSAGOC,K,CAAQ,KAAKP,KAAL,CAAWC,K,CACzB,KAAKO,QAAL,CAAc,CAAEH,MAAM,CAAE,SAAV,CAAd,E,sCAEyBhC,CAAAA,KAAK,CAACoC,IAAN,CACrB,WADqB,CAErB,GAAIC,CAAAA,eAAJ,CAAoB,CAAEH,KAAK,CAALA,KAAF,CAApB,CAFqB,C,wCAAfI,I,mBAAAA,I,CAIRC,OAAO,CAACC,GAAR,CAAYF,IAAZ,E,KACIA,IAAI,CAACG,IAAL,CAAUT,MAAV,GAAqB/B,UAAU,CAACyC,EAAX,CAAcC,QAAd,E,gCACjB,IAAIC,CAAAA,KAAJ,CAAUN,IAAI,CAACG,IAAL,CAAUI,OAApB,C,SAEN,KAAKV,QAAL,CAAc,CACZN,IAAI,CAAEb,SAAS,CAACsB,IAAI,CAACrB,QAAN,CADH,CAEZa,MAAM,CAAEQ,IAAI,CAACQ,SAFD,CAGZd,MAAM,CAAE,QAHI,CAAd,E,yFAOFO,OAAO,CAACC,GAAR,CAAY,YAAIK,OAAhB,EACA,KAAKV,QAAL,CAAc,CAAEH,MAAM,CAAE,OAAV,CAAmBC,YAAY,CAAE,YAAIY,OAArC,CAAd,E,mOAImB,CACrB,OAAQ,KAAKlB,KAAL,CAAWK,MAAnB,EACE,IAAK,eAAL,CACE,mBAAO,oBAAC,KAAD,2CAAP,CACF,IAAK,SAAL,CACE,mBAAO,oBAAC,KAAD,sBAAP,CACF,IAAK,QAAL,CACE,mBACE,oBAAC,YAAD,EACE,IAAI,CAAE,KAAKL,KAAL,CAAWE,IADnB,CAEE,MAAM,CAAE,KAAKF,KAAL,CAAWG,MAFrB,CAGE,WAAW,CAAE,KAAKH,KAAL,CAAWI,WAH1B,EADF,CAOF,IAAK,OAAL,CACE,mBACE,oBAAC,KAAD,MACG,mDACC,KAAKJ,KAAL,CAAWM,YAFf,CADF,CAMF,QACE,mBAAO,oBAAC,KAAD,8BAAP,CArBJ,CAuBD,C,kDAEYc,K,CAAO,CAClB,KAAKZ,QAAL,CAAc,CAAEP,KAAK,CAAEmB,KAAK,CAACC,MAAN,CAAapB,KAAtB,CAAd,EACD,C,uCAEQ,CACP;AACA;AACA,mBACE,oBAAC,KAAD,CAAO,QAAP,mBACE,oBAAC,KAAD,mBADF,cAEE,oBAAC,SAAD,EACE,KAAK,CAAE,KAAKD,KAAL,CAAWC,KADpB,CAEE,QAAQ,CAAE,KAAKJ,YAFjB,CAGE,EAAE,CAAC,qBAHL,CAIE,KAAK,CAAC,aAJR,CAKE,KAAK,CAAE,CAAEd,MAAM,CAAE,CAAV,CALT,CAME,WAAW,CAAC,iDANd,CAOE,UAAU,CAAC,iCAPb,CAQE,SAAS,KARX,CASE,MAAM,CAAC,QATT,CAUE,eAAe,CAAE,CACfuC,MAAM,CAAE,IADO,CAVnB,EAFF,cAgBE,oBAAC,YAAD,EAAc,OAAO,CAAE,KAAKvB,WAA5B,EAhBF,CAiBG,KAAKwB,oBAAL,EAjBH,CADF,CAqBD,C,mBA7FiBnD,KAAK,CAACoD,S,EAgG1B,QAASC,CAAAA,YAAT,CAAsB7B,KAAtB,CAA6B,CAC3B,GAAM8B,CAAAA,OAAO,CAAG9C,SAAS,EAAzB,CACA,mBACE,2BAAK,SAAS,CAAE8C,OAAO,CAAC5C,IAAxB,eACE,oBAAC,MAAD,EAAQ,OAAO,CAAC,UAAhB,CAA2B,OAAO,CAAEc,KAAK,CAAC+B,OAA1C,WADF,CADF,CAOD,CAED,cAAehC,CAAAA,KAAf","sourcesContent":["/**\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      https://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport axios from 'axios';\nimport * as HttpStatus from 'http-status-codes';\nimport { makeStyles } from '@material-ui/core/styles';\nimport QueryResults from './QueryResults';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport Title from '../../Utilities/Title';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    margin: theme.spacing(1),\n  },\n}));\n\n//JSON data parsing here\nfunction addKey(index, responseObj) {\n  responseObj.id = index;\n  return responseObj;\n}\n\nfunction parseRows(response) {\n  const responseRows = [];\n  let i;\n  for (i = 0; i < response.length; i++) {\n    responseRows.push(addKey(i, response[i]));\n  }\n  return responseRows;\n}\n\nclass Query extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleChange = this.handleChange.bind(this);\n    this.handleQuery = this.handleQuery.bind(this);\n    this.state = {\n      value: '',\n      rows: [],\n      fields: [],\n      rowsPerPage: 5,\n      status: 'inputRequired',\n      errorMessage: '',\n    };\n  }\n\n  async handleQuery() {\n    const query = this.state.value;\n    this.setState({ status: 'loading' });\n    try {\n      const { data } = await axios.post(\n        '/campaign',\n        new URLSearchParams({ query }),\n      );\n      console.log(data);\n      if (data.meta.status !== HttpStatus.OK.toString()) {\n        throw new Error(data.meta.message);\n      } else {\n        this.setState({\n          rows: parseRows(data.response),\n          fields: data.fieldmask,\n          status: 'loaded',\n        });\n      }\n    } catch (err) {\n      console.log(err.message);\n      this.setState({ status: 'error', errorMessage: err.message });\n    }\n  }\n\n  pickContentToDisplay() {\n    switch (this.state.status) {\n      case 'inputRequired':\n        return <Title> Enter a query to see the results </Title>;\n      case 'loading':\n        return <Title> Loading ... </Title>;\n      case 'loaded':\n        return (\n          <QueryResults\n            rows={this.state.rows}\n            fields={this.state.fields}\n            rowsPerPage={this.state.rowsPerPage}\n          />\n        );\n      case 'error':\n        return (\n          <Title>\n            {\"Something Went Wrong. Here's the Error Message: \" +\n              this.state.errorMessage}\n          </Title>\n        );\n      default:\n        return <Title> Something Went Wrong</Title>;\n    }\n  }\n\n  handleChange(event) {\n    this.setState({ value: event.target.value });\n  }\n\n  render() {\n    // const rows = this.state.rows;\n    // const fields = this.state.fields;\n    return (\n      <React.Fragment>\n        <Title>Query Here</Title>\n        <TextField\n          value={this.state.value}\n          onChange={this.handleChange}\n          id=\"standard-full-width\"\n          label=\"Enter Query\"\n          style={{ margin: 8 }}\n          placeholder=\"SELECT campaign.id, campaign.name FROM campaign\"\n          helperText=\"make sure to select an account!\"\n          fullWidth\n          margin=\"normal\"\n          InputLabelProps={{\n            shrink: true,\n          }}\n        />\n        <SubmitButton onClick={this.handleQuery} />\n        {this.pickContentToDisplay()}\n      </React.Fragment>\n    );\n  }\n}\n\nfunction SubmitButton(props) {\n  const classes = useStyles();\n  return (\n    <div className={classes.root}>\n      <Button variant=\"outlined\" onClick={props.onClick}>\n        Submit\n      </Button>\n    </div>\n  );\n}\n\nexport default Query;\n"]},"metadata":{},"sourceType":"module"}